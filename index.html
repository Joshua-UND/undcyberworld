<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Joshua Christopher — Fullstack · Cloud · AI Automation</title>

  <!-- Fonts: Inter for UI, Merriweather for headings -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Merriweather:ital,wght@0,700;0,900;1,700&display=swap" rel="stylesheet">

  <!-- Tailwind (light usage for utilities) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --bg: #fbfaf8;            /* soft whitish paper background */
      --ink: #0b1520;           /* deep ink */
      --accent: #2563EB;        /* refined blue accent (less neon, more classical) */
      --accent-soft: #60A5FA;   /* softer accent for subtle glows */
      --gold: #B88B3A;          /* antique/gold highlight (sparingly) */
      --glass: rgba(255,255,255,0.72);
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      color:var(--ink);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
      -webkit-text-size-adjust:100%;
    }

    /* very subtle tactile paper */
    body::before{
      content:"";
      position:fixed; inset:0; pointer-events:none;
      background-image: radial-gradient(rgba(0,0,0,0.01) 1px, transparent 1px);
      background-size:3px 3px;
      mix-blend-mode: overlay;
      opacity:0.55;
    }

    /* layout container */
    .site { max-width:1100px; margin:48px auto; padding:0 20px; }

    /* navigation — minimal and light */
    nav { display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:18px; }
    .brand { display:flex; gap:12px; align-items:center; text-decoration:none; color:var(--ink); }
    .badge {
      width:44px; height:44px; border-radius:10px;
      background: linear-gradient(135deg, var(--accent), var(--accent-soft));
      color:#fff; display:flex; align-items:center; justify-content:center; font-weight:800; font-family:Merriweather,serif;
      box-shadow: 0 10px 30px rgba(37,99,235,0.10);
    }
    .nav-links { display:flex; gap:14px; align-items:center; }
    .nav-links a { color:var(--ink); text-decoration:none; font-weight:600; font-size:14px; }
    .nav-cta { background:transparent; border:2px solid var(--accent); color:var(--accent); padding:6px 12px; border-radius:9px; font-weight:700; text-decoration:none; }

    /* HERO: improved responsive layout; prevents overflow */
    .hero {
      display:flex; gap:28px; align-items:stretch;
      background: linear-gradient(180deg, rgba(255,255,255,0.86), rgba(255,255,255,0.92));
      border-radius:14px; padding:28px; box-shadow: 0 10px 30px rgba(11,21,32,0.04);
      border:1px solid rgba(11,21,32,0.03);
      overflow:hidden;
    }
    @media (max-width:1024px){ .hero { flex-direction:column; } }

    .hero-main { flex:1 1 600px; min-width:0; } /* min-width:0 prevents overflow with long text */
    .hero-side { width:320px; flex:0 0 320px; display:flex; flex-direction:column; gap:12px; align-items:center; }
    @media (max-width:1024px){ .hero-side { width:100%; flex:auto; } }

    h1 { font-family: 'Merriweather', serif; font-size:30px; margin:0; line-height:1.02; color:var(--ink); }
    .sub { color:var(--accent); font-weight:700; margin-top:6px; font-size:13px; letter-spacing:0.2px; }
    .lead { color:rgba(11,21,32,0.78); margin-top:12px; font-size:15px; max-width:60ch; overflow-wrap:break-word; }

    /* typing (smaller, non-overflowing) */
    .typing { display:inline-block; border-right:2px solid var(--accent); padding-right:6px; margin-left:8px; font-weight:700; color:var(--accent); font-family:Merriweather,serif; font-size:15px; vertical-align:middle; white-space:nowrap; max-width:100%; overflow:hidden; text-overflow:ellipsis; }

    /* profile side */
    .profile-card {
      width:100%;
      background: linear-gradient(180deg, rgba(255,255,255,0.82), rgba(255,255,255,0.78));
      border-radius:12px; padding:14px; display:flex; flex-direction:column; align-items:center; gap:8px;
      border:1px solid rgba(11,21,32,0.03);
    }
    .profile-pic { width:160px; height:160px; border-radius:12px; overflow:hidden; box-shadow: 0 20px 40px rgba(37,99,235,0.06); border:1px solid rgba(11,21,32,0.03); }
    .profile-pic img { width:100%; height:100%; object-fit:cover; display:block; }

    .profile-actions { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:8px; }
    .btn-ghost { padding:8px 12px; border-radius:10px; background:transparent; border:1px solid rgba(11,21,32,0.06); font-weight:700; color:var(--ink); text-decoration:none; }
    .btn-primary { padding:8px 12px; border-radius:10px; background:var(--accent); color:#fff; font-weight:700; text-decoration:none; box-shadow: 0 8px 18px rgba(37,99,235,0.08); }

    /* Marquee — subtle and smaller */
    .marquee-wrap { margin-top:14px; overflow:hidden; transform:skewY(-2deg); border-radius:10px; }
    .marquee { display:flex; gap:12px; animation:marq 20s linear infinite; padding:8px 4%; }
    .marq-pill { background:rgba(37,99,235,0.06); color:var(--ink); padding:6px 12px; border-radius:99px; font-weight:700; font-size:13px;}
    @keyframes marq { 0%{transform:translateX(0)} 100%{transform:translateX(-50%)} }

    /* Projects grid: softer cards, reduced heavy shadows */
    .projects { margin-top:28px; display:grid; gap:16px; grid-template-columns: repeat(1,1fr); }
    @media (min-width:640px){ .projects { grid-template-columns: repeat(2,1fr); } }
    @media (min-width:1024px){ .projects { grid-template-columns: repeat(3,1fr); } }

    .project {
      background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(254,254,253,0.98));
      border-radius:12px; padding:12px; border:1px solid rgba(11,21,32,0.03);
      transition: transform .22s ease, box-shadow .22s ease;
    }
    .project:hover { transform: translateY(-6px); box-shadow: 0 12px 30px rgba(11,21,32,0.04); }
    .thumb { height:140px; border-radius:10px; overflow:hidden; background:linear-gradient(180deg,#fff,#fafafa); display:flex; align-items:center; justify-content:center; border:1px solid rgba(11,21,32,0.03); }
    .thumb img { width:100%; height:100%; object-fit:cover; display:block; }

    .meta { display:flex; justify-content:space-between; align-items:center; margin-top:8px; }
    .actions { display:flex; gap:8px; margin-top:10px; }

    /* Contact form — vintage-paper aesthetic, improved UI */
    .contact-wrap { margin-top:24px; background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96)); border-radius:12px; padding:18px; border:1px solid rgba(11,21,32,0.03); }
    .contact-header { font-family:Merriweather, serif; font-weight:800; font-size:18px; }
    .form-grid { display:grid; gap:10px; grid-template-columns:1fr 1fr; margin-top:10px; }
    @media (max-width:640px){ .form-grid { grid-template-columns: 1fr; } }

    label.vintage { display:block; font-family:Merriweather, serif; font-size:12px; color:rgba(11,21,32,0.6); margin-bottom:6px; }
    input.vinput, textarea.vinput, select.vinput {
      width:100%; padding:12px 10px; border-radius:8px; border:1px solid rgba(11,21,32,0.06); background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(248,248,247,0.98)); font-size:14px; color:var(--ink);
      box-shadow: inset 0 -6px 18px rgba(255,255,255,0.5);
    }
    .submit {
      display:inline-flex; gap:10px; align-items:center; padding:10px 14px; background:linear-gradient(90deg,var(--gold),var(--accent)); color:white; border-radius:10px; font-weight:800; border:none; cursor:pointer;
      box-shadow: 0 10px 30px rgba(37,99,235,0.08);
    }

    /* Footer simpler */
    footer { margin-top:36px; text-align:center; color:rgba(11,21,32,0.6); font-size:13px; }

    /* Modal fallback small */
    .modal-root { position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:80; }
  </style>
</head>
<body>

  <div class="site">
    <nav>
      <a class="brand" href="#home" aria-label="Home">
        <div class="badge">JC</div>
        <div>
          <div style="font-family:Merriweather,serif; font-weight:800;">Joshua Christopher</div>
          <div style="font-size:12px; color:rgba(11,21,32,0.56); margin-top:2px;">Fullstack · Cloud · AI Automation</div>
        </div>
      </a>

      <div class="nav-links" role="navigation" aria-label="Main links">
        <a href="#projects">Work</a>
        <a href="#about">About</a>
        <a href="#contact">Contact</a>
        <a href="#contact" class="nav-cta">Hire</a>
      </div>
    </nav>

    <!-- HERO -->
    <header class="hero" id="home" role="banner" aria-labelledby="hero-title">
      <div class="hero-main">
        <h1 id="hero-title">Joshua Christopher</h1>
        <div class="sub">Fullstack · Cloud Engineer · AI Automation Specialist</div>

        <p class="lead">
          I design and ship dependable systems — product-grade web apps, resilient cloud platforms, and LLM-driven automations that make teams faster and products kinder.
        </p>

        <p style="margin-top:14px;">
          I specialize in
          <span id="typing" class="typing" aria-live="polite"></span>
        </p>

        <div style="margin-top:16px; display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn-primary" href="#projects">View Work</a>
          <a class="btn-ghost" href="#about">Experience</a>
        </div>

        <div class="marquee-wrap" aria-hidden="true">
          <div class="marquee">
            <div class="marq-pill">React</div>
            <div class="marq-pill">Terraform</div>
            <div class="marq-pill">LangChain</div>
            <div class="marq-pill">Postgres</div>
            <div class="marq-pill">Serverless</div>
            <div class="marq-pill">TypeScript</div>
            <div class="marq-pill">Observability</div>
            <div class="marq-pill">Automation</div>
            <div class="marq-pill">React</div>
            <div class="marq-pill">Terraform</div>
            <div class="marq-pill">LangChain</div>
          </div>
        </div>
      </div>

      <aside class="hero-side">
        <div class="profile-card" aria-label="Profile">
          <div class="profile-pic" aria-hidden="false">
            <img id="profile-photo" src="" alt="Joshua Christopher — profile photo">
          </div>

          <div style="text-align:center;">
            <div style="font-weight:800; color:var(--ink);">Available for projects</div>
            <div style="font-size:13px; color:rgba(11,21,32,0.64); margin-top:6px;">Remote · Contract friendly</div>
          </div>

          <div class="profile-actions">
            <a id="github-link" class="btn-ghost" href="https://github.com/Joshua-UND" target="_blank" rel="noopener noreferrer">GitHub</a>
            <a id="linkedin-link" class="btn-ghost" href="https://www.linkedin.com/in/joshuachristopher-und" target="_blank" rel="noopener noreferrer">LinkedIn</a>
          </div>
        </div>
      </aside>
    </header>

    <!-- SERVICES -->
    <section id="services" class="mt-8">
      <div style="display:grid; grid-template-columns:repeat(3,1fr); gap:12px;">
        <div class="project">
          <div style="font-weight:800;">Fullstack</div>
          <div class="muted" style="margin-top:8px;">Product web apps with solid testing and monitoring.</div>
        </div>
        <div class="project">
          <div style="font-weight:800;">Cloud</div>
          <div class="muted" style="margin-top:8px;">IaC, serverless, containers and cost-conscious designs.</div>
        </div>
        <div class="project">
          <div style="font-weight:800;">AI</div>
          <div class="muted" style="margin-top:8px;">LLM orchestration and automation-first flows.</div>
        </div>
      </div>
    </section>

    <!-- PROJECTS: auto-pin top 3 -->
    <section id="projects" class="mt-8">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
        <div>
          <h2 style="font-family:Merriweather,serif; font-weight:800; margin:0;">Selected Projects</h2>
          <div class="muted" style="margin-top:6px;">Top repositories are auto-pinned for quick preview.</div>
        </div>
        <div class="muted" style="font-size:13px;">Use left/right arrows to cycle featured</div>
      </div>

      <!-- featured row -->
      <div style="display:flex; gap:12px; align-items:flex-start; margin-bottom:12px; flex-wrap:wrap;">
        <div style="flex:1 1 640px; min-width:260px;">
          <div id="featured-card" style="background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.96)); padding:12px; border-radius:12px; border:1px solid rgba(11,21,32,0.03); box-shadow:0 8px 20px rgba(11,21,32,0.03);">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <div>
                <div class="muted" style="font-size:12px;">Featured</div>
                <div id="featured-title" style="font-weight:800; margin-top:6px;">Loading top project…</div>
              </div>
              <div style="display:flex; gap:8px;">
                <button id="fe-prev" class="btn-ghost">◀</button>
                <button id="fe-next" class="btn-ghost">▶</button>
              </div>
            </div>

            <div id="featured-preview" class="iframe-wrap" style="margin-top:12px;">Attempting live preview…</div>
            <div id="featured-links" style="display:flex; gap:8px; justify-content:flex-end; margin-top:10px;"></div>
          </div>
        </div>

        <div style="width:320px; min-width:260px;">
          <div style="background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.96)); padding:12px; border-radius:12px; border:1px solid rgba(11,21,32,0.03);">
            <div style="font-weight:800;">Pinned Projects</div>
            <div id="pinned-list" style="margin-top:10px; display:flex; flex-direction:column; gap:8px;"></div>
          </div>
        </div>
      </div>

      <!-- grid -->
      <div id="projects-grid" class="projects"></div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="mt-8">
      <div style="display:flex; gap:12px; align-items:start; flex-wrap:wrap;">
        <div style="flex:1 1 640px;">
          <h2 style="font-family:Merriweather,serif; font-weight:800;">About</h2>
          <p class="muted" style="margin-top:8px;">I ship production systems and automations that help teams focus on what matters. I favor careful design, pragmatic tooling, and durable automation.</p>
        </div>

        <aside style="width:260px;">
          <div style="background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.96)); padding:12px; border-radius:12px; border:1px solid rgba(11,21,32,0.03);">
            <div style="font-weight:800;">Quick stats</div>
            <div style="display:flex; gap:12px; margin-top:10px;">
              <div>
                <div id="stat-projects" style="font-weight:800; font-size:18px;">0</div>
                <div class="muted" style="font-size:12px;">Projects</div>
              </div>
              <div>
                <div id="stat-years" style="font-weight:800; font-size:18px;">0</div>
                <div class="muted" style="font-size:12px;">Years</div>
              </div>
            </div>
          </div>
        </aside>
      </div>
    </section>

    <!-- CONTACT: vintage-styled form -->
    <section id="contact" class="mt-8">
      <div class="contact-wrap">
        <div class="contact-header">Get in touch</div>
        <div class="muted" style="margin-top:6px;">Prefer email? Use the contact form below and it will prepare a pre-filled message for your mail client.</div>

        <form id="contact-form" style="margin-top:12px;">
          <div class="form-grid">
            <div>
              <label class="vintage">Name</label>
              <input class="vinput" name="name" required placeholder="Your full name" />
            </div>
            <div>
              <label class="vintage">Email</label>
              <input class="vinput" name="email" type="email" required placeholder="you@domain.com" />
            </div>
          </div>

          <div style="margin-top:10px;">
            <label class="vintage">Service</label>
            <select class="vinput" name="service">
              <option>Fullstack / Web App</option>
              <option>Cloud / Infra</option>
              <option>AI Automation</option>
              <option>Consulting</option>
            </select>
          </div>

          <div style="margin-top:10px;">
            <label class="vintage">Message</label>
            <textarea class="vinput" name="message" rows="4" placeholder="Tell me about your project..."></textarea>
          </div>

          <div style="margin-top:12px; display:flex; gap:10px; align-items:center;">
            <button type="submit" class="submit" id="submit-btn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M2 12l20-9-9 20-3-8-8-3z" fill="white"/></svg>
              Send message
            </button>
            <div class="muted" style="font-size:13px;">I'll respond quickly — thank you.</div>
          </div>
        </form>
      </div>
    </section>

    <footer style="margin-top:28px; text-align:center;">
      <div style="font-weight:700;">Joshua Christopher</div>
      <div class="muted" style="margin-top:6px;">Fullstack · Cloud · AI Automation</div>
      <div class="muted" style="margin-top:8px; font-size:13px;">© <span id="year"></span></div>
    </footer>
  </div>

  <!-- modal root -->
  <div id="modal-root" class="modal-root" aria-live="polite"></div>

  <script>
    /* ======================================================
       Improved UI fixes:
       - Hero overflow fixed by using min-width:0 on main column and fixed side width + responsive stacking
       - Reduced repeated email: email only appears in Contact form and footer
       - Accent color refined to var(--accent) and soft variant
       - Reduced heavy card shadows and gradients; softer borders
       - Contact form styled with vintage/1900s-inspired labels and a warmer submit button
       - Projects & featured: live preview attempts with graceful fallback (iframe blocked -> show fallback)
       ====================================================== */

    const GITHUB_USER = 'Joshua-UND';
    const MAX_REPOS = 9;
    const PINNED = 3;

    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));

    // set profile pic from GitHub (fallback placeholder)
    async function setProfile() {
      try {
        const r = await fetch(`https://api.github.com/users/${GITHUB_USER}`);
        if (r.ok) {
          const data = await r.json();
          if (data.avatar_url) {
            $('#profile-photo').src = data.avatar_url;
          } else {
            $('#profile-photo').src = 'https://placehold.co/400x400?text=Joshua';
          }
        } else {
          $('#profile-photo').src = 'https://placehold.co/400x400?text=Joshua';
        }
      } catch (e) {
        $('#profile-photo').src = 'https://placehold.co/400x400?text=Joshua';
      }
    }

    // fetch repos and attempt readme image extraction (best-effort)
    async function fetchRepos() {
      try {
        const res = await fetch(`https://api.github.com/users/${GITHUB_USER}/repos?per_page=100`);
        if (!res.ok) throw new Error('GitHub API');
        const data = await res.json();
        data.sort((a,b) => (b.stargazers_count - a.stargazers_count) || (new Date(b.pushed_at) - new Date(a.pushed_at)));
        return data.slice(0, MAX_REPOS);
      } catch (e) {
        console.warn('Failed to fetch repos', e);
        return null;
      }
    }

    async function readmeImage(repoName, defaultBranch='main') {
      try {
        const r = await fetch(`https://api.github.com/repos/${GITHUB_USER}/${repoName}/readme`);
        if (!r.ok) return null;
        const json = await r.json();
        if (!json.content) return null;
        const decoded = atob(json.content.replace(/\n/g,''));
        const m = decoded.match(/!\[[^\]]*]\(([^)]+)\)/i) || decoded.match(/<img[^>]+src=['"]([^'"]+)['"]/i);
        if (!m) return null;
        let url = m[1].trim();
        if (!/^https?:\/\//i.test(url)) {
          url = url.replace(/^\/+/,'');
          return `https://raw.githubusercontent.com/${GITHUB_USER}/${repoName}/${defaultBranch}/${url}`;
        }
        return url;
      } catch (e) {
        return null;
      }
    }

    async function buildProjects() {
      await setProfile();
      const repos = await fetchRepos();
      let items = [];
      if (!repos) {
        // fallback simple list to avoid empty UI
        items = [
          { name:'undcyberworld', desc:'This portfolio (repo)', homepage:'', html_url:`https://github.com/${GITHUB_USER}/undcyberworld`, stars:0, updated:new Date().toISOString(), language:'HTML', image:null },
          { name:'ai-task-automator', desc:'LLM-driven automations', homepage:'', html_url:'#', stars:0, updated:new Date().toISOString(), language:'Python', image:null },
          { name:'infra-templates', desc:'Terraform modules', homepage:'', html_url:'#', stars:0, updated:new Date().toISOString(), language:'Terraform', image:null }
        ];
        render(items);
        return;
      }

      // enrich with readme images when available (best-effort)
      const enriched = [];
      for (let r of repos) {
        const img = await readmeImage(r.name, r.default_branch);
        enriched.push({
          name: r.name,
          desc: r.description || '',
          homepage: r.homepage || '',
          html_url: r.html_url,
          stars: r.stargazers_count,
          updated: r.pushed_at,
          language: r.language || '',
          image: img
        });
      }
      render(enriched);
    }

    // UI helpers
    function render(items) {
      // pinned top
      const pinned = items.slice(0, PINNED);
      setupFeatured(pinned);

      // projects grid
      const grid = $('#projects-grid');
      grid.innerHTML = '';
      items.forEach(it => {
        const card = document.createElement('article');
        card.className = 'project';
        card.innerHTML = `
          <div class="thumb">${it.image ? `<img src="${it.image}" alt="${it.name} screenshot" />` : `<div class="muted">No image</div>`}</div>
          <div style="margin-top:8px;">
            <div style="font-weight:700;">${escapeHtml(it.name)}</div>
            <div class="muted" style="margin-top:6px;">${escapeHtml(it.desc || '')}</div>
            <div class="meta">
              <div class="muted" style="font-size:12px;">${it.language ? it.language.toUpperCase() : ''}</div>
              <div class="muted" style="font-size:12px;">★ ${it.stars || 0}</div>
            </div>
            <div class="actions">
              ${ it.homepage ? `<button class="btn-primary preview-btn" data-home="${escapeHtml(it.homepage)}" data-name="${escapeHtml(it.name)}">Live</button>` : '' }
              <a class="btn-ghost" href="${it.html_url}" target="_blank" rel="noopener noreferrer">Source</a>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });

      // attach preview handlers
      $$('.preview-btn').forEach(b => {
        b.addEventListener('click', () => {
          openModal({ homepage: b.dataset.home, html_url: null, name: b.dataset.name });
        });
      });

      // stats
      $('#stat-projects').textContent = items.length;
      $('#stat-years').textContent = 5;
    }

    /* Featured carousel */
    let FEATURED = [];
    let fi = 0;
    function setupFeatured(pinned) {
      FEATURED = pinned;
      const list = $('#pinned-list'); list.innerHTML = '';
      pinned.forEach((p, idx) => {
        const row = document.createElement('div');
        row.style.display = 'flex'; row.style.justifyContent = 'space-between'; row.style.alignItems = 'center';
        row.innerHTML = `<div style="font-weight:700;">${escapeHtml(p.name)}</div><div><a class="btn-ghost" href="${p.html_url}" target="_blank">Source</a></div>`;
        row.addEventListener('click', () => { fi = idx; renderFeatured(); });
        list.appendChild(row);
      });

      $('#fe-prev').onclick = () => { fi = (fi - 1 + FEATURED.length) % FEATURED.length; renderFeatured(); };
      $('#fe-next').onclick = () => { fi = (fi + 1) % FEATURED.length; renderFeatured(); };

      // keyboard left/right
      window.addEventListener('keydown', (e) => {
        if (['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) return;
        if (e.key === 'ArrowLeft') $('#fe-prev').click();
        if (e.key === 'ArrowRight') $('#fe-next').click();
      });

      renderFeatured();
    }

    function renderFeatured() {
      const wrap = $('#featured-preview'); wrap.innerHTML = '';
      const title = $('#featured-title');
      if (!FEATURED || FEATURED.length === 0) {
        title.textContent = 'No featured projects';
        wrap.innerHTML = `<div class="muted">No preview</div>`;
        $('#featured-links').innerHTML = '';
        return;
      }
      const p = FEATURED[fi];
      title.textContent = p.name;
      $('#featured-links').innerHTML = `${p.homepage ? `<a class="btn-primary" href="${p.homepage}" target="_blank">Open Live</a>` : ''} <a class="btn-ghost" href="${p.html_url}" target="_blank">Source</a>`;

      if (p.homepage && /^https?:\/\//i.test(p.homepage)) {
        const iframe = document.createElement('iframe');
        iframe.src = p.homepage;
        iframe.style.width = '100%'; iframe.style.height = '100%'; iframe.style.border = '0';
        iframe.loading = 'lazy';
        let loaded = false;
        const t = setTimeout(() => { if (!loaded) showFeaturedFallback(p); }, 3500);
        iframe.addEventListener('load', () => { loaded = true; clearTimeout(t); wrap.innerHTML = ''; wrap.appendChild(iframe); });
        wrap.appendChild(iframe);
      } else if (p.image) {
        const img = document.createElement('img'); img.src = p.image; img.style.width='100%'; img.style.height='100%'; img.style.objectFit='cover';
        wrap.appendChild(img);
      } else {
        showFeaturedFallback(p);
      }
    }

    function showFeaturedFallback(p) {
      $('#featured-preview').innerHTML = `<div style="padding:18px; text-align:center;"><div style="font-weight:700;">Preview unavailable</div><div class="muted" style="margin-top:8px;">Open the project to view live demo or source.</div></div>`;
    }

    /* Modal + focus trap (simple) */
    let lastActive = null;
    function openModal({ homepage, html_url, name }) {
      lastActive = document.activeElement;
      const root = $('#modal-root');
      root.style.display = 'flex';
      root.innerHTML = `
        <div style="position:fixed; inset:0; background:rgba(2,6,23,0.5); display:flex; align-items:center; justify-content:center; z-index:90;">
          <div style="width:95%; max-width:1000px; background:white; border-radius:12px; overflow:hidden; outline:none;">
            <div style="display:flex; justify-content:space-between; align-items:center; padding:12px 14px; border-bottom:1px solid rgba(11,21,32,0.03);">
              <div><div class="muted" style="font-size:12px;">Project</div><div style="font-weight:800;">${escapeHtml(name)}</div></div>
              <div style="display:flex; gap:8px; align-items:center;">
                ${homepage ? `<a class="btn-primary" href="${homepage}" target="_blank">Open Live</a>` : ''}
                ${html_url ? `<a class="btn-ghost" href="${html_url}" target="_blank">Source</a>` : ''}
                <button id="close-modal" class="btn-ghost">Close</button>
              </div>
            </div>
            <div style="padding:12px;">
              <div id="modal-frame" style="height:60vh; border-radius:8px; overflow:hidden; background:linear-gradient(180deg,#fff,#f7fbff); display:flex; align-items:center; justify-content:center;">
                <div class="muted">Attempting to load preview…</div>
              </div>
            </div>
          </div>
        </div>
      `;
      // load iframe
      const frame = document.getElementById('modal-frame');
      if (homepage && /^https?:\/\//i.test(homepage)) {
        const iframe = document.createElement('iframe');
        iframe.src = homepage; iframe.style.width='100%'; iframe.style.height='100%'; iframe.style.border='0'; iframe.loading='lazy';
        let loaded=false;
        const to = setTimeout(()=>{ if(!loaded) frame.innerHTML = `<div class="muted">Preview blocked / timed out. Use Open Live or Source.</div>`; }, 4500);
        iframe.addEventListener('load', ()=>{ loaded=true; clearTimeout(to); frame.innerHTML=''; frame.appendChild(iframe); });
        frame.appendChild(iframe);
      } else {
        frame.innerHTML = `<div class="muted">No homepage available to embed. Use Source link.</div>`;
      }

      // close handler & basic focus restore
      $('#close-modal').addEventListener('click', closeModal);
      // click backdrop to close
      root.firstElementChild.addEventListener('click', (e)=>{ if (e.target === root.firstElementChild) closeModal(); });
      // Esc to close
      window.addEventListener('keydown', escClose);
    }

    function closeModal(){
      const root = $('#modal-root');
      root.style.display = 'none';
      root.innerHTML = '';
      if (lastActive && typeof lastActive.focus === 'function') lastActive.focus();
      window.removeEventListener('keydown', escClose);
    }
    function escClose(e){ if (e.key === 'Escape') closeModal(); }

    // typing animation (non-overflowing)
    const typingEl = document.getElementById('typing');
    const words = ['Fullstack Engineering','Cloud Infrastructure','AI Automation'];
    let wi = 0, pos = 0, deleting=false;
    function tick(){
      const w = words[wi];
      if (!deleting) {
        pos++; typingEl.textContent = w.slice(0,pos);
        if (pos === w.length) { deleting=true; setTimeout(tick,1200); return; }
      } else {
        pos--; typingEl.textContent = w.slice(0,pos);
        if (pos === 0) { deleting=false; wi = (wi+1)%words.length; }
      }
      setTimeout(tick, deleting ? 60 : 100);
    }
    setTimeout(tick,600);

    // contact form -> mailto prefill
    document.getElementById('contact-form').addEventListener('submit', (e)=>{
      e.preventDefault();
      const f = e.target;
      const name = f.name.value || '';
      const email = f.email.value || '';
      const service = f.service.value || '';
      const message = f.message.value || '';
      const subject = encodeURIComponent(`Inquiry: ${service}`);
      const body = encodeURIComponent(`Name: ${name}\nEmail: ${email}\n\n${message}`);
      window.open(`mailto:undcyberworld@gmail.com?subject=${subject}&body=${body}`, '_blank');
    });

    // small helpers
    function escapeHtml(s) { return (s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
    document.getElementById('year').textContent = new Date().getFullYear();

    // initialize
    buildProjects();
  </script>
</body>
</html>
